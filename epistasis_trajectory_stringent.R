#Rcode
library(RColorBrewer)
mycol <- brewer.pal(8,'Accent')
mycol <- c(mycol,mycol)
a1<- read.table('analysis/stringent_trajectory_epistasis.txt',)
e1 <- read.table('analysis/stringent_trajectory_epistasis_std.txt')
png('figures/stringent_trajectory_epistasis.png',res=600,height=3000,width=3000)
par(mar=c(4,4,4,4))
plot(c(1,4),c(-0.5,2),type='n',xlab='hamming distance to WT',ylab='trajectory based epistasis',xaxt='n')
axis(side=1,at=seq(1,4),labels=seq(1,4))
segments(a1[,2],a1[,3],a1[,4],a1[,5],lwd=2,col=mycol[a1[,6]])
#segments(e1[,2],e1[,3]-e1[,4],e1[,2],e1[,3]+e1[,4],col=mycol[e1[,5]])
#segments(e1[,2]-0.1,e1[,3]-e1[,4],e1[,2]+0.1,e1[,3]-e1[,4],col=mycol[e1[,5]])
#segments(e1[,2]-0.1,e1[,3]+e1[,4],e1[,2]+0.1,e1[,3]+e1[,4],col=mycol[e1[,5]])
abline(h=0,lty=2,lwd=2,col='grey')
legend('topleft',col=mycol[seq(1,13)],legend=unique(a1[,1]),pch='-',lwd=2,cex=0.6)
dev.off()
